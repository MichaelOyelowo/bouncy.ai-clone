<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consent mode</title>
<style>
* {
    box-sizing: border-box;
    padding: 0;
    margin: 0;
}

.switch-button {
    position: relative;
    display: inline-block;
    width: 44px;
    height: 24px;
}

.switch-button input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #e2e8f0; /* Default Gray */
    /* transition: .2s; */
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    /* transition: .2s; */
    border-radius: 50%;
}

input:checked + .slider {
    background-color: #084c58; /* Bouncy Brand Teal */
}

input:checked + .slider:before {
    transform: translateX(20px);
}

.cookie-banner {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #f9fafb;
    border: 1px solid #dcdfe5;
    border-radius: 1rem;
    box-shadow: 0 -4px 24px -4px hsl(220, 20%, 20% / 0.12), 0 -2px 8px -2px hsl(220, 20%, 20% / 0.8);
    width: 90%;
    max-width: 800px;
    padding: 1.5rem;
    z-index: 40;
}
.cookie-banner-body {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.cookie-logo {
    flex-shrink: 0;
    border-radius: .75rem;
    padding: 0.625rem;
    background-color: #2a6df41a;
    color: #084c58;
}

.cookie-banner-content {
    flex: 1 1 0%;
    min-width: 0;
    border-color: #e2e4e9;
}

.cookie-banner-content h2 {
    color: #16181d;
    margin-bottom: 0.375rem;
    margin-top: 0;
    font-size: 1.125rem;
    line-height: 1.75rem;
    font-weight: 600;
}

.cookie-banner-content p {
        color: #6a7181;
        line-height: 1.625rem;
        font-size: .875rem;
}

.cookies-pref {
    display: flex;
    gap: 0.75rem;
    margin-top: 1.25rem;
}

.pref-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: .5rem;
    height: 2.5rem;
    line-height: 1.25rem;
    font-size: 0.875rem;
    white-space: nowrap;
    border-radius: 10px;
    padding: 0.5rem 1rem;
    font-weight: 500;
    border: none;
    cursor: pointer;
}

.btn-manage {
    color: #6a7181;
    background-color: transparent;
    transition: background-color 0.2s ease, color 0.2s ease;
}

.btn-manage:hover {
    background-color: #f3f4f6;
    color: #111827; 
}

.btn-manage:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px #fff, 0 0 0 4px #084c58;
}

.btn-reject {
    background-color: #ffffff;
    border: 1px solid #e2e8f0;
    color: #1f2937;
    transition: background-color 0.2s ease, color 0.2s ease;
}

.btn-reject:hover {
    background-color: #f3f4f6;
    color: #111827;
}

.btn-reject:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px #fff, 0 0 0 4px #084c58;
}

.btn-accept {
    background-color: #084c58;
    color: #ffffff;
    transition: background-color 0.2s ease;
}

/* --- HOVER STATE --- */
.btn-accept:hover {
    background-color: #0a5e6d; 
}

.btn-accept:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px #fff, 0 0 0 4px #084c58;
}

@media (max-width: 640px) {
    .cookies-pref {
        width: 90%;
        flex-direction: column;
        margin: 10px auto 0 auto;
    }
    .btn-manage {
        order: 3;
    }
    .btn-reject {
        order: 2;
    }
    .btn-accept {
        order: 1;
    }
}

.consent-bg-fullscreen {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    backdrop-filter: blur(4px);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3 ease;
    z-index: 60;
}

.bg-consent-overlay {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #16181d99;
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    animation: fade-in 0.8s ease;
}

@keyframes fade-in {
    0% {
        opacity: 0;
        transform: translateY(10px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

.consent-card-container {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    max-height: 85vh;
    max-width: 36rem;
    overflow: hidden;
    border-radius: 1rem;
    border-width: 1px;
    border-color: #2a2e37;
    background-color: #ffffff;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    z-index: 999;
}

.consent-card-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid #e2e4e9;
    padding: 1.25rem;
}

.consent-card-head h2 {
    font-size: 1.25rem;
    line-height: 1.75rem;
    font-weight: 600;
    color: #16181d;
}

.consent-card-head button {
    cursor: pointer;
    border-radius: 0.75rem;
    padding: 0.5rem;
    border: none;
    outline: none;
    background: transparent;
    transition: background-color 0.2s ease;
}

/* --- HOVER STATE --- */
.consent-card-head button:hover {
    background-color: #f1f5f9;
}

.consent-card-head svg {
     width: 1.25rem;
    height: 1.25rem;
    color: #64748b;
    transition: color 0.2s ease;
}

.cookies-content {
    padding: 1.25rem;
    max-height: 540px;
    overflow-y: auto;
}

.cookies-content .m-15{
    margin-bottom: 15px;
}

.save-cookie-pref {
    padding: 1rem;
    background-color: #f3f4f680;
    border-color: #e2e4e9;
    border-width: 1px;
    border-radius: .75rem;
    margin-bottom: 15px;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.save-c-p-box {
    flex-shrink: 0;
    border-radius: 0.75rem;
    background-color: #fff;
    padding: .5rem;
    color: #788e92;
}

.save-cookie-container {
    flex: 1 1 0%;
}

.save-cookie-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: .25rem;
    gap: 1rem;
}

.save-cookie-inner h3 {
    color:#16181d;
    font-weight: 500;
}

.save-cookie-inner .ml-2 {
    margin-left: 0.5rem;
    font-size: .95rem;
    line-height: 1rem;
    font-weight: 400;
    color: #6a7181;
}

.save-cookie-container p {
    font-size: .875rem;
    line-height: 1.25rem;
    color: #6a7181;
}

.bottom-content {
    display: flex;
    gap: .375rem;
    margin-top: .5rem;
    flex-wrap: wrap;
}

.bottom-content span {
    display: inline-flex;
    align-items: center;
    border-radius: .25rem;
    border-width: 1px;
    color: #e2e4e9;
    background-color: #ffffff;
    padding: 0.125rem .5rem;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;
    font-size: .75rem;
    line-height: 1rem;
    color: #6a7181;
}

.consent-btn {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: .75rem;
    border-top: 1px;
    border-color: #e2e4e9;
    background-color: #f3f4f64d;
    padding: 1.25rem;
}

.consent-btn button {
    cursor: pointer;
    display: inline-flex;
    height: 2.5rem;
    align-items: center;
    justify-content: center;
    gap: .5rem;
    white-space: nowrap;
    border-radius: 10px;
    border-width: 1px;
    padding: 0.5rem 1rem;
    font-size: .875rem;
    line-height: 1.25rem;
    font-weight: 500;
    outline: none;
    transition: background-color 0.2s ease;
}

.consent-btn button:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px #ffffff, 0 0 0 4px #084c58;
}

.c-btn-cancel {
    border-color: #e2e4e9;
    background-color: #ffffff;
}
.c-btn-cancel:hover {
    background-color: #f1f5f9;
    color: #0f172a;
}

.c-btn-save {
    border: none;
    background-color: #f4f4f5;
    color: #18181b; 
}

.c-btn-save:hover {
    background-color: #e4e4e7;
}

.c-btn-accept {
    border: none;
    background-color: #084c58;
    color: #ffffff;
}

.c-btn-accept:hover {
    background-color: #0a5e6d; 
}

@media (max-width: 680px) {
    .consent-card-container {
        margin: 0 10px;
    }
    .consent-btn {
        justify-content: center;
    }
}
</style>
</head>
<body>
    <div class="cookie-banner">
        <div class="cookie-banner-body">
            <div class="cookie-logo">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cookie">
                    <path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"></path><path d="M8.5 8.5v.01"></path><path d="M16 15.5v.01"></path><path d="M12 12v.01"></path><path d="M11 17v.01"></path><path d="M7 14v.01"></path>
                </svg>
            </div>
            <div class="cookie-banner-content">
                <h2>We value your privacy</h2>
                <p>We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our 
                    traffic. By clicking "Accept All", you consent to our use of cookies. You can customize your preferences
                    by clicking "Manage".
                </p>
            </div>
        </div>
        <div class="cookies-pref">
            <button class="pref-btn btn-manage" id="manageCookies">Manage</button>
            <button class="pref-btn btn-reject" id="rejectAll">Reject All</button>
            <button class="pref-btn btn-accept" id="acceptAll">Accept All</button>
        </div>
    </div>

    <div class="consent-bg-fullscreen" id="consent-bg">
        <div class="bg-consent-overlay" id="bg-consent-overlay">
            <div class="consent-card-container">
                <div class="consent-card-head">
                    <h2>Cookie Preferences</h2>
                    <button id="consent-close-btn" aria-label="Close">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6 6 18"></path><path d="m6 6 12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="cookies-content">
                    <p class="m-15">Manage your cookie preferences below. You can enable or disable different types of cookies.
                         Note that disabling some cookies may affect your experience on our website.
                    </p>
                    <div class="save-cookie-pref">
                        <div class="save-c-p-box">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-5 w-5">
                                <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path>
                            </svg>
                        </div>
                        <div class="save-cookie-container">
                            <div class="save-cookie-inner">
                                <h3>Strictly Necessary<span class="ml-2">(Required)</span></h3>
                                <label class="switch-button">
                                    <input type="checkbox" checked disabled/>
                                    <span class="slider round" style="cursor: not-allowed;opacity: 0.6;"></span>
                                </label>
                            </div>
                            <p>
                                Essential cookies that enable core functionality like security, network management, and 
                                accessibility. These cannot be disabled.
                            </p>
                            <div class="bottom-content">
                                <span>
                                    security_storage
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="save-cookie-pref">
                        <div class="save-c-p-box">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chart-column h-5 w-5">
                                <path d="M3 3v16a2 2 0 0 0 2 2h16"></path><path d="M18 17V9"></path><path d="M13 17V5"></path><path d="M8 17v-3"></path>
                            </svg>
                        </div>
                        <div class="save-cookie-container">
                            <div class="save-cookie-inner">
                                <h3>Analytics</h3>
                                <label class="switch-button">
                                    <input type="checkbox" id="analytics-toggle"/>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <p>
                                Help us understand how visitors interact with our website by collecting and reporting information anonymously.
                            </p>
                            <div class="bottom-content">
                                <span>
                                    analytics_storage
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="save-cookie-pref">
                        <div class="save-c-p-box">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-megaphone h-5 w-5">
                                <path d="m3 11 18-5v12L3 14v-3z"></path><path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"></path>
                            </svg>
                        </div>
                        <div class="save-cookie-container">
                            <div class="save-cookie-inner">
                                <h3>Marketing</h3>
                                <label class="switch-button">
                                    <input type="checkbox" id="marketing-toggle"/>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <p>
                                Used to track visitors across websites to display relevant advertisements based on the visitor's interests.
                            </p>
                            <div class="bottom-content">
                                <span>ad_storage</span>
                                <span>ad_user_data</span>
                                <span>ad_personalization</span>
                            </div>
                        </div>
                        
                    </div>

                    <div class="save-cookie-pref">
                        <div class="save-c-p-box">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings2 h-5 w-5">
                                <path d="M20 7h-9"></path><path d="M14 17H5"></path><circle cx="17" cy="17" r="3"></circle><circle cx="7" cy="7" r="3"></circle>
                            </svg>
                        </div>
                        <div class="save-cookie-container">
                            <div class="save-cookie-inner">
                                <h3>Preferences</h3>
                                <label class="switch-button">
                                    <input type="checkbox" id="preferences-toggle"/>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <p>
                                Enable personalized features and remember your settings like language preferences and region selection.
                            </p>
                            <div class="bottom-content">
                                <span>functionality_storage</span>
                                <span>personalization_storage</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="consent-btn">
                    <button class="c-btn-cancel" id="c-btn-cancel">Cancel</button>
                    <button class="c-btn-save">Save Preferences</button>
                    <button class="c-btn-accept">Accept All</button>
                </div>
            </div>
        </div>
    </div>

<script>
    // ============================================
// COOKIE CONSENT MANAGER WITH GOOGLE CONSENT MODE V2
// ============================================

const CONSENT_STORAGE_KEY = 'cookie_consent';
const CONSENT_COOKIE_NAME = 'cookie_consent';
const COOKIE_EXPIRY_DAYS = 365;

const DEFAULT_CONSENT = {
  necessary: true,
  analytics: false,
  marketing: false,
  preferences: false,
};

const ACCEPT_ALL_CONSENT = {
  necessary: true,
  analytics: true,
  marketing: true,
  preferences: true,
};

// ============================================
// COOKIE HELPERS
// ============================================

function setCookie(name, value, days) {
  const date = new Date();
  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
  const expires = "expires=" + date.toUTCString();
  document.cookie = name + "=" + encodeURIComponent(JSON.stringify(value)) + ";" + expires + ";path=/;SameSite=Lax;Secure";
}

function getCookie(name) {
  const nameEQ = name + "=";
  const cookies = document.cookie.split(';');
  for (let i = 0; i < cookies.length; i++) {
    let cookie = cookies[i].trim();
    if (cookie.indexOf(nameEQ) === 0) {
      try {
        return JSON.parse(decodeURIComponent(cookie.substring(nameEQ.length)));
      } catch (e) {
        return null;
      }
    }
  }
  return null;
}

function deleteCookie(name) {
  document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;";
}

// ============================================
// CONSENT STORAGE (localStorage + Cookies)
// ============================================

function saveConsentToStorage(consentState) {
  // Save to localStorage
  try {
    localStorage.setItem(CONSENT_STORAGE_KEY, JSON.stringify(consentState));
  } catch (e) {
    console.error('Failed to save to localStorage:', e);
  }
  
  // Save to cookie (for server-side access & GTM)
  setCookie(CONSENT_COOKIE_NAME, consentState, COOKIE_EXPIRY_DAYS);
}

function loadConsentFromStorage() {
  // Try localStorage first
  try {
    const stored = localStorage.getItem(CONSENT_STORAGE_KEY);
    if (stored) {
      return JSON.parse(stored);
    }
  } catch (e) {
    console.error('Failed to load from localStorage:', e);
  }
  
  // Fallback to cookie
  const cookieConsent = getCookie(CONSENT_COOKIE_NAME);
  if (cookieConsent) {
    return cookieConsent;
  }
  
  return null;
}

function clearConsentStorage() {
  try {
    localStorage.removeItem(CONSENT_STORAGE_KEY);
  } catch (e) {}
  deleteCookie(CONSENT_COOKIE_NAME);
}

// ============================================
// GOOGLE CONSENT MODE V2 UPDATE
// ============================================

function updateGoogleConsent(preferences) {
  const consentUpdate = {
    ad_storage: preferences.marketing ? 'granted' : 'denied',
    ad_user_data: preferences.marketing ? 'granted' : 'denied',
    ad_personalization: preferences.marketing ? 'granted' : 'denied',
    analytics_storage: preferences.analytics ? 'granted' : 'denied',
    functionality_storage: preferences.preferences ? 'granted' : 'denied',
    personalization_storage: preferences.preferences ? 'granted' : 'denied',
    security_storage: 'granted',
  };

  if (typeof gtag === 'function') {
    gtag('consent', 'update', consentUpdate);
    console.log('Google Consent Mode v2 updated:', consentUpdate);
  } else {
    console.log('gtag not available. Consent would be:', consentUpdate);
  }
}

// ============================================
// SAVE CONSENT
// ============================================

function saveConsent(preferences) {
  const consentState = {
    hasConsented: true,
    preferences: { ...preferences, necessary: true },
    timestamp: new Date().toISOString(),
  };
  
  saveConsentToStorage(consentState);
  updateGoogleConsent(preferences);
  hideBanner();
  hideManageModal();
}

// ============================================
// UI CONTROLS
// ============================================

function showBanner() {
  document.querySelector('.cookie-banner').style.display = 'block';
}

function hideBanner() {
  document.querySelector('.cookie-banner').style.display = 'none';
}

function showManageModal() {
  const modal = document.querySelector('.consent-bg-fullscreen');
  modal.style.opacity = '1';
  modal.style.visibility = 'visible';
}

function hideManageModal() {
  const modal = document.querySelector('.consent-bg-fullscreen');
  modal.style.opacity = '0';
  modal.style.visibility = 'hidden';
}

function updateToggleUI(preferences) {
  const analyticsToggle = document.getElementById('analytics-toggle');
  const marketingToggle = document.getElementById('marketing-toggle');
  const preferencesToggle = document.getElementById('preferences-toggle');
  
  if (analyticsToggle) analyticsToggle.checked = preferences.analytics;
  if (marketingToggle) marketingToggle.checked = preferences.marketing;
  if (preferencesToggle) preferencesToggle.checked = preferences.preferences;
}

function getTogglesState() {
  return {
    necessary: true,
    analytics: document.getElementById('analytics-toggle')?.checked || false,
    marketing: document.getElementById('marketing-toggle')?.checked || false,
    preferences: document.getElementById('preferences-toggle')?.checked || false,
  };
}

// ============================================
// INITIALIZATION
// ============================================

function initConsentManager() {
  const stored = loadConsentFromStorage();
  
  if (stored && stored.hasConsented) {
    // User already consented - update GTM and hide banner
    updateGoogleConsent(stored.preferences);
    hideBanner();
  } else {
    // No consent yet - show banner
    showBanner();
  }

  // Accept All (Banner)
  document.querySelector('.btn-accept')?.addEventListener('click', function() {
    saveConsent(ACCEPT_ALL_CONSENT);
  });

  // Reject All (Banner)
  document.querySelector('.btn-reject')?.addEventListener('click', function() {
    saveConsent(DEFAULT_CONSENT);
  });

  // Manage (Banner) - opens modal
  document.querySelector('.btn-manage')?.addEventListener('click', function() {
    const stored = loadConsentFromStorage();
    const currentPrefs = stored?.preferences || DEFAULT_CONSENT;
    updateToggleUI(currentPrefs);
    showManageModal();
  });

  // Close modal (X button)
  document.querySelector('.consent-card-head button')?.addEventListener('click', function() {
    hideManageModal();
  });

  // Cancel (Modal)
  document.querySelector('.c-btn-cancel')?.addEventListener('click', function() {
    hideManageModal();
  });

  // Save Preferences (Modal)
  document.querySelector('.c-btn-save')?.addEventListener('click', function() {
    const preferences = getTogglesState();
    saveConsent(preferences);
  });

  // Accept All (Modal)
  document.querySelector('.c-btn-accept')?.addEventListener('click', function() {
    saveConsent(ACCEPT_ALL_CONSENT);
  });

  // Click outside modal to close
 const overlay = document.querySelector('.bg-consent-overlay');
  const modalBox = document.querySelector('.consent-card-container');

  // 1. Only close if the background (overlay) itself is clicked
  overlay?.addEventListener('click', function(e) {
    if (e.target === overlay) {
      hideManageModal();
    }
  });
}

// Run on DOM ready
document.addEventListener('DOMContentLoaded', initConsentManager);

</script>
</body>
</html>